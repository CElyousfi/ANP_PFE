2025-03-28 02:49:17,838 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-28 02:49:17,839 - __main__ - INFO - Created data folder: data
2025-03-28 02:49:17,839 - __main__ - INFO - Created department folder: data/general
2025-03-28 02:49:17,839 - __main__ - INFO - Created department folder: data/commercial
2025-03-28 02:49:17,839 - __main__ - INFO - Created department folder: data/technical
2025-03-28 02:49:17,839 - __main__ - INFO - Created department folder: data/safety
2025-03-28 02:49:17,839 - __main__ - INFO - Created department folder: data/regulatory
2025-03-28 02:49:17,839 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-28 02:49:17,839 - __main__ - INFO - Found 1 documents in general department
2025-03-28 02:49:17,839 - __main__ - INFO - Found 4 documents in regulatory department
2025-03-28 02:49:17,839 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-28 02:49:17,839 - __main__ - INFO - Environment: Production
2025-03-28 02:58:11,736 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-28 02:58:11,737 - __main__ - INFO - Created data folder: data
2025-03-28 02:58:11,737 - __main__ - INFO - Created department folder: data/general
2025-03-28 02:58:11,737 - __main__ - INFO - Created department folder: data/commercial
2025-03-28 02:58:11,737 - __main__ - INFO - Created department folder: data/technical
2025-03-28 02:58:11,737 - __main__ - INFO - Created department folder: data/safety
2025-03-28 02:58:11,737 - __main__ - INFO - Created department folder: data/regulatory
2025-03-28 02:58:11,737 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-28 02:58:11,737 - __main__ - INFO - Found 1 documents in general department
2025-03-28 02:58:11,737 - __main__ - INFO - Found 4 documents in regulatory department
2025-03-28 02:58:11,737 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-28 02:58:11,737 - __main__ - INFO - Environment: Production
2025-03-28 02:58:12,353 - src.api.app - INFO - Initializing embeddings model...
2025-03-28 02:58:12,353 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-28 02:58:12,357 - src.api.app - INFO - Initializing LLM service...
2025-03-28 02:58:12,357 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-28 02:58:12,357 - src.api.app - INFO - Initializing document processor...
2025-03-28 02:58:12,357 - src.api.app - INFO - Initializing document database...
2025-03-28 02:58:12,358 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-28 02:58:12,358 - src.api.app - INFO - Initializing vector store...
2025-03-28 02:58:12,358 - src.api.app - INFO - Loading vector stores...
2025-03-28 02:58:12,358 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-28 02:58:12,359 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-28 02:58:12,397 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-28 02:58:12,399 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-28 02:58:12,400 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,400 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-28 02:58:12,400 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,400 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-28 02:58:12,400 - src.core.vector_store - WARNING - Error loading existing index for commercial, creating new one: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open faiss_index/commercial/index.faiss for reading: No such file or directory
2025-03-28 02:58:12,400 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-28 02:58:12,400 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,401 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-28 02:58:12,401 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-28 02:58:12,401 - src.core.vector_store - WARNING - Error loading existing index for technical, creating new one: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open faiss_index/technical/index.faiss for reading: No such file or directory
2025-03-28 02:58:12,401 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-28 02:58:12,401 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,401 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-28 02:58:12,401 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-28 02:58:12,402 - src.core.vector_store - WARNING - Error loading existing index for safety, creating new one: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open faiss_index/safety/index.faiss for reading: No such file or directory
2025-03-28 02:58:12,402 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-28 02:58:12,402 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,402 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-28 02:58:12,402 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-28 02:58:12,402 - src.core.vector_store - WARNING - Error loading existing index for regulatory, creating new one: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open faiss_index/regulatory/index.faiss for reading: No such file or directory
2025-03-28 02:58:12,402 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-28 02:58:12,402 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,403 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-28 02:58:12,403 - src.api.app - INFO - Successfully initialized vector stores
2025-03-28 02:58:12,403 - src.api.app - INFO - Initializing response generator...
2025-03-28 02:58:12,403 - src.api.app - INFO - Initializing file watcher...
2025-03-28 02:58:12,403 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-28 02:58:12,404 - src.core.file_watcher - INFO - File watcher started
2025-03-28 02:58:12,404 - src.api.app - INFO - File watcher started
2025-03-28 02:58:12,404 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-28 02:58:12,405 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-28 02:58:12,405 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-28 02:58:12,405 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:12,405 - src.core.document_processor - WARNING - No supported document files found in data/commercial
2025-03-28 02:58:12,406 - src.core.document_processor - WARNING - No supported document files found in data/technical
2025-03-28 02:58:12,406 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-28 02:58:12,407 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-28 02:58:12,410 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-28 02:58:12,410 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-28 02:58:12,410 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-28 02:58:12,410 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:12,410 - src.core.document_processor - INFO - Loaded 5 total documents from all folders
2025-03-28 02:58:12,410 - src.api.app - INFO - Found 5 existing documents to process
2025-03-28 02:58:12,411 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-28 02:58:12,411 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-28 02:58:12,411 - src.core.vector_store - INFO - Creating vectorstore from 5 chunks
2025-03-28 02:58:12,411 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-28 02:58:12,412 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Creating vectorstore for department general from 1 chunks
2025-03-28 02:58:12,412 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-28 02:58:12,412 - src.core.document_processor - WARNING - No valid documents to split
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-28 02:58:12,412 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 4 chunks
2025-03-28 02:58:12,412 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:12,413 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-28 02:58:12,413 - src.api.app - INFO - Existing documents processed and indexed
2025-03-28 02:58:17,431 - src.core.file_watcher - INFO - File watcher stopped
2025-03-28 02:58:17,431 - src.api.app - INFO - File watcher stopped
2025-03-28 02:58:20,001 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-28 02:58:20,001 - __main__ - INFO - Created data folder: data
2025-03-28 02:58:20,001 - __main__ - INFO - Created department folder: data/general
2025-03-28 02:58:20,001 - __main__ - INFO - Created department folder: data/commercial
2025-03-28 02:58:20,001 - __main__ - INFO - Created department folder: data/technical
2025-03-28 02:58:20,001 - __main__ - INFO - Created department folder: data/safety
2025-03-28 02:58:20,001 - __main__ - INFO - Created department folder: data/regulatory
2025-03-28 02:58:20,001 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-28 02:58:20,001 - __main__ - INFO - Found 1 documents in general department
2025-03-28 02:58:20,001 - __main__ - INFO - Found 4 documents in regulatory department
2025-03-28 02:58:20,001 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-28 02:58:20,001 - __main__ - INFO - Environment: Production
2025-03-28 02:58:20,606 - src.api.app - INFO - Initializing embeddings model...
2025-03-28 02:58:20,607 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-28 02:58:20,610 - src.api.app - INFO - Initializing LLM service...
2025-03-28 02:58:20,610 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-28 02:58:20,610 - src.api.app - INFO - Initializing document processor...
2025-03-28 02:58:20,611 - src.api.app - INFO - Initializing document database...
2025-03-28 02:58:20,611 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-28 02:58:20,611 - src.api.app - INFO - Initializing vector store...
2025-03-28 02:58:20,611 - src.api.app - INFO - Loading vector stores...
2025-03-28 02:58:20,611 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-28 02:58:20,612 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-28 02:58:20,652 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-28 02:58:20,655 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-28 02:58:20,655 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,655 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-28 02:58:20,655 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,656 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-28 02:58:20,656 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,656 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-28 02:58:20,656 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,656 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-28 02:58:20,656 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,656 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-28 02:58:20,656 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,656 - src.api.app - INFO - Successfully initialized vector stores
2025-03-28 02:58:20,656 - src.api.app - INFO - Initializing response generator...
2025-03-28 02:58:20,656 - src.api.app - INFO - Initializing file watcher...
2025-03-28 02:58:20,656 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-28 02:58:20,657 - src.core.file_watcher - INFO - File watcher started
2025-03-28 02:58:20,657 - src.api.app - INFO - File watcher started
2025-03-28 02:58:20,658 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-28 02:58:20,658 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-28 02:58:20,659 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-28 02:58:20,659 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:20,659 - src.core.document_processor - WARNING - No supported document files found in data/commercial
2025-03-28 02:58:20,660 - src.core.document_processor - WARNING - No supported document files found in data/technical
2025-03-28 02:58:20,660 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-28 02:58:20,660 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-28 02:58:20,663 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:20,663 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:20,663 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-28 02:58:20,663 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-28 02:58:20,664 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-28 02:58:20,664 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Loaded 5 total documents from all folders
2025-03-28 02:58:20,664 - src.api.app - INFO - Found 5 existing documents to process
2025-03-28 02:58:20,664 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-28 02:58:20,664 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-28 02:58:20,664 - src.core.vector_store - INFO - Creating vectorstore from 5 chunks
2025-03-28 02:58:20,665 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,665 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-28 02:58:20,665 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-28 02:58:20,665 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-28 02:58:20,665 - src.core.vector_store - INFO - Creating vectorstore for department general from 1 chunks
2025-03-28 02:58:20,665 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,666 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-28 02:58:20,666 - src.core.document_processor - WARNING - No valid documents to split
2025-03-28 02:58:20,666 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-28 02:58:20,666 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 4 chunks
2025-03-28 02:58:20,666 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 02:58:20,667 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-28 02:58:20,667 - src.api.app - INFO - Existing documents processed and indexed
2025-03-28 03:00:59,381 - src.core.file_watcher - INFO - New file detected: data/regulatory/port_regulations.txt
2025-03-28 03:00:59,382 - src.core.file_watcher - INFO - New file detected: data/technical/equipment_specifications.txt
2025-03-28 03:00:59,382 - src.core.file_watcher - INFO - New file detected: data/commercial/port_tariffs.txt
2025-03-28 03:00:59,387 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-28 03:00:59,387 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-28 03:00:59,388 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-28 03:00:59,388 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,388 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:00:59,388 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-28 03:00:59,388 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,389 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:00:59,389 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-28 03:00:59,389 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,389 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-28 03:00:59,390 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-28 03:00:59,390 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-28 03:00:59,390 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:00:59,390 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-28 03:00:59,391 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Loaded 8 total documents from all folders
2025-03-28 03:00:59,391 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-28 03:00:59,392 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-28 03:00:59,392 - src.core.vector_store - INFO - Creating vectorstore from 16 chunks
2025-03-28 03:00:59,393 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,394 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-28 03:00:59,395 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-28 03:00:59,395 - src.core.vector_store - INFO - Creating vectorstore for department general from 1 chunks
2025-03-28 03:00:59,395 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,395 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-28 03:00:59,395 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-28 03:00:59,395 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-28 03:00:59,395 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,396 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-28 03:00:59,396 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-28 03:00:59,396 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-28 03:00:59,396 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,396 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-28 03:00:59,396 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-28 03:00:59,397 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,397 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-28 03:00:59,397 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-28 03:00:59,397 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 7 chunks
2025-03-28 03:00:59,397 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:00:59,398 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-28 03:00:59,398 - src.api.endpoints - INFO - Successfully rebuilt indexes with 16 chunks from 8 documents
2025-03-28 03:01:04,382 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:01:04,382 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-28 03:01:04,382 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:01:04,382 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:01:04,382 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:01:04,382 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-28 03:01:04,383 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-28 03:01:04,383 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:01:04,383 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-28 03:01:04,383 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:01:04,383 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-28 03:01:04,383 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:01:04,384 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:01:04,384 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-28 03:01:04,384 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:01:04,386 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-28 03:01:04,386 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,387 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,387 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,387 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,387 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-28 03:01:04,389 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-28 03:01:04,389 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,389 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,389 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,389 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,389 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-28 03:01:04,394 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-28 03:01:04,394 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,394 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,394 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:01:04,394 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:01:04,394 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-28 03:01:09,399 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,399 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,403 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,403 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,406 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,406 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,409 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,409 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,411 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,411 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,414 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,414 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,416 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,416 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,419 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,419 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,421 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,421 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,425 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:01:09,425 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:02:58,578 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-28 03:02:58,578 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-28 03:02:58,578 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-28 03:02:58,584 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-28 03:02:58,584 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-28 03:02:58,584 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-28 03:02:58,584 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,585 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:02:58,585 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-28 03:02:58,585 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,585 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:02:58,586 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-28 03:02:58,586 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,586 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-28 03:02:58,586 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-28 03:02:58,586 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-28 03:02:58,587 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-28 03:02:58,587 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-28 03:02:58,587 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:02:58,587 - src.core.document_processor - INFO - Loaded 8 total documents from all folders
2025-03-28 03:02:58,588 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-28 03:02:58,588 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-28 03:02:58,588 - src.core.vector_store - INFO - Creating vectorstore from 16 chunks
2025-03-28 03:02:58,588 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,589 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-28 03:02:58,589 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-28 03:02:58,589 - src.core.vector_store - INFO - Creating vectorstore for department general from 1 chunks
2025-03-28 03:02:58,590 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,590 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-28 03:02:58,590 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-28 03:02:58,590 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-28 03:02:58,590 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,591 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-28 03:02:58,591 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-28 03:02:58,591 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-28 03:02:58,591 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,591 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-28 03:02:58,592 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-28 03:02:58,592 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,592 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-28 03:02:58,592 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-28 03:02:58,592 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 7 chunks
2025-03-28 03:02:58,592 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-28 03:02:58,593 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-28 03:02:58,593 - src.api.endpoints - INFO - Successfully rebuilt indexes with 16 chunks from 8 documents
2025-03-28 03:03:03,578 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:03:03,579 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:03:03,579 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-28 03:03:03,579 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:03:03,579 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-28 03:03:03,579 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-28 03:03:03,579 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-28 03:03:03,579 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:03:03,580 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-28 03:03:03,583 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-28 03:03:03,583 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,583 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,583 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,583 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,583 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-28 03:03:03,585 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-28 03:03:03,585 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,585 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,585 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,585 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,585 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-28 03:03:03,588 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-28 03:03:03,588 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,588 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,588 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-28 03:03:03,588 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-28 03:03:03,589 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-28 03:03:08,596 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,596 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,599 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,599 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,602 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,602 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,605 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,605 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,608 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,608 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,611 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,611 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,613 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,613 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,616 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,616 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,618 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,618 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,620 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,620 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,623 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-28 03:03:08,623 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-28 14:29:22,499 - src.core.file_watcher - INFO - File watcher stopped
2025-03-28 14:29:22,500 - src.api.app - INFO - File watcher stopped
2025-03-30 16:57:21,535 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 16:57:21,535 - __main__ - INFO - Created data folder: data
2025-03-30 16:57:21,535 - __main__ - INFO - Created department folder: data/general
2025-03-30 16:57:21,535 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 16:57:21,535 - __main__ - INFO - Created department folder: data/technical
2025-03-30 16:57:21,536 - __main__ - INFO - Created department folder: data/safety
2025-03-30 16:57:21,536 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 16:57:21,536 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 16:57:21,536 - __main__ - INFO - Found 2 documents in general department
2025-03-30 16:57:21,536 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 16:57:21,536 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 16:57:21,536 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 16:57:21,536 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 16:57:21,536 - __main__ - INFO - Environment: Production
2025-03-30 16:57:22,261 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 16:57:22,261 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 16:57:22,271 - src.api.app - INFO - Initializing LLM service...
2025-03-30 16:57:22,271 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 16:57:22,271 - src.api.app - INFO - Initializing document processor...
2025-03-30 16:57:22,271 - src.api.app - INFO - Initializing document database...
2025-03-30 16:57:22,272 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 16:57:22,272 - src.api.app - INFO - Initializing vector store...
2025-03-30 16:57:22,272 - src.api.app - INFO - Loading vector stores...
2025-03-30 16:57:22,272 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 16:57:22,274 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 16:57:22,319 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 16:57:22,322 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 16:57:22,324 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,324 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 16:57:22,325 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,325 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 16:57:22,325 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,325 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 16:57:22,326 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,326 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 16:57:22,326 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,326 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 16:57:22,326 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,326 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 16:57:22,326 - src.api.app - INFO - Initializing response generator...
2025-03-30 16:57:22,326 - src.api.app - INFO - Initializing file watcher...
2025-03-30 16:57:22,327 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 16:57:22,328 - src.core.file_watcher - INFO - File watcher started
2025-03-30 16:57:22,328 - src.api.app - INFO - File watcher started
2025-03-30 16:57:22,328 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 16:57:22,329 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 16:57:22,332 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,332 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,332 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 16:57:22,332 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 16:57:22,333 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,333 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:57:22,333 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 16:57:22,333 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,334 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:57:22,334 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 16:57:22,334 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,334 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 16:57:22,335 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 16:57:22,335 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 16:57:22,335 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,335 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 16:57:22,336 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 16:57:22,336 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 16:57:22,336 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 16:57:22,336 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,336 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 16:57:22,336 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 16:57:22,337 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 16:57:22,337 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 16:57:22,337 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 16:57:22,337 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,337 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 16:57:22,338 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 16:57:22,338 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 16:57:22,338 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 16:57:22,338 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:22,339 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 16:57:22,339 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 16:57:22,339 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 16:57:22,339 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 16:57:22,339 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 16:57:22,341 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,344 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 16:57:22,344 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 16:57:22,344 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 16:57:22,344 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 16:57:22,344 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 16:57:22,345 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 16:57:22,345 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 16:57:22,345 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 16:57:22,345 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 16:57:22,345 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,346 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 16:57:22,346 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:57:22,346 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 16:57:22,346 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 16:57:22,346 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:22,347 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 16:57:22,347 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 16:57:39,180 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 16:57:39,180 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 16:57:39,180 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 16:57:39,185 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 16:57:39,186 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 16:57:39,186 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,186 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,187 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 16:57:39,187 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 16:57:39,187 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,187 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:57:39,188 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 16:57:39,188 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,188 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:57:39,188 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 16:57:39,188 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,189 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 16:57:39,189 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 16:57:39,189 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,189 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,189 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 16:57:39,190 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 16:57:39,190 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 16:57:39,190 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 16:57:39,190 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,190 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,191 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 16:57:39,191 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 16:57:39,192 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 16:57:39,192 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 16:57:39,192 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 16:57:39,192 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,192 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:57:39,193 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 16:57:39,193 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:39,193 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 16:57:39,193 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 16:57:39,193 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 16:57:39,193 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 16:57:39,193 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,195 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 16:57:39,195 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 16:57:39,195 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 16:57:39,195 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 16:57:39,196 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 16:57:39,196 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 16:57:39,197 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,197 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 16:57:39,197 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 16:57:39,197 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,198 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 16:57:39,198 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 16:57:39,198 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 16:57:39,198 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:57:39,199 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 16:57:39,199 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 16:57:44,180 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:57:44,181 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:57:44,181 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 16:57:44,181 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:57:44,181 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:57:44,181 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 16:57:44,181 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 16:57:44,181 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:57:44,182 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:57:44,182 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 16:57:44,182 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 16:57:44,182 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:44,182 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 16:57:44,183 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:44,183 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:57:44,185 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:57:44,185 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,186 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,186 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,186 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,186 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 16:57:44,188 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 16:57:44,188 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,188 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,188 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,188 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,188 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 16:57:44,193 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:57:44,193 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,193 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,193 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:57:44,193 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:57:44,193 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 16:57:49,196 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,196 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,200 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,200 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,204 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,204 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,207 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,207 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,209 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,209 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,212 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,212 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,214 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,215 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,218 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,218 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,222 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,223 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,227 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,227 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,231 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:57:49,231 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:44,227 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 16:58:44,227 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 16:58:44,228 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 16:58:44,233 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 16:58:44,233 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 16:58:44,233 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,233 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,233 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 16:58:44,233 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 16:58:44,234 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,234 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:58:44,234 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 16:58:44,234 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,234 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:58:44,235 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 16:58:44,235 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,235 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 16:58:44,236 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 16:58:44,236 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 16:58:44,236 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,236 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 16:58:44,236 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 16:58:44,237 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 16:58:44,237 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 16:58:44,237 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 16:58:44,237 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 16:58:44,237 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,237 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,238 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 16:58:44,238 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 16:58:44,239 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 16:58:44,239 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 16:58:44,239 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 16:58:44,239 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,241 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 16:58:44,241 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 16:58:44,241 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 16:58:44,241 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 16:58:44,242 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 16:58:44,242 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 16:58:44,243 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,243 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 16:58:44,243 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 16:58:44,243 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,243 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 16:58:44,243 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 16:58:44,243 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 16:58:44,243 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 16:58:44,244 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 16:58:44,245 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 16:58:49,227 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:58:49,228 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:58:49,228 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 16:58:49,228 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 16:58:49,228 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:58:49,228 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 16:58:49,228 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 16:58:49,228 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:49,229 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 16:58:49,231 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:58:49,232 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,232 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,232 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,232 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,232 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 16:58:49,234 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 16:58:49,234 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,234 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,235 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,235 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,235 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 16:58:49,239 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 16:58:49,240 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,240 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,240 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 16:58:49,240 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 16:58:49,240 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 16:58:54,242 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,242 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,245 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,245 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,247 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,248 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,250 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,250 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,253 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,253 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,256 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,256 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,259 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,259 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,262 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,262 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,265 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,265 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,268 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,268 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,271 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 16:58:54,271 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:01,539 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 17:10:01,540 - src.api.app - INFO - File watcher stopped
2025-03-30 17:10:03,179 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 17:10:03,179 - __main__ - INFO - Created data folder: data
2025-03-30 17:10:03,179 - __main__ - INFO - Created department folder: data/general
2025-03-30 17:10:03,179 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 17:10:03,179 - __main__ - INFO - Created department folder: data/technical
2025-03-30 17:10:03,180 - __main__ - INFO - Created department folder: data/safety
2025-03-30 17:10:03,180 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 17:10:03,180 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 17:10:03,180 - __main__ - INFO - Found 2 documents in general department
2025-03-30 17:10:03,180 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 17:10:03,180 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 17:10:03,180 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 17:10:03,180 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 17:10:03,180 - __main__ - INFO - Environment: Production
2025-03-30 17:10:03,816 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 17:10:03,816 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 17:10:03,820 - src.api.app - INFO - Initializing LLM service...
2025-03-30 17:10:03,821 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 17:10:03,821 - src.api.app - INFO - Initializing document processor...
2025-03-30 17:10:03,821 - src.api.app - INFO - Initializing document database...
2025-03-30 17:10:03,821 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 17:10:03,821 - src.api.app - INFO - Initializing vector store...
2025-03-30 17:10:03,821 - src.api.app - INFO - Loading vector stores...
2025-03-30 17:10:03,821 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 17:10:03,822 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 17:10:03,866 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 17:10:03,869 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 17:10:03,870 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,870 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 17:10:03,870 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,870 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 17:10:03,870 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,870 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 17:10:03,870 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,870 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 17:10:03,870 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,870 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 17:10:03,871 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,871 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 17:10:03,871 - src.api.app - INFO - Initializing response generator...
2025-03-30 17:10:03,871 - src.api.app - INFO - Initializing file watcher...
2025-03-30 17:10:03,871 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 17:10:03,872 - src.core.file_watcher - INFO - File watcher started
2025-03-30 17:10:03,872 - src.api.app - INFO - File watcher started
2025-03-30 17:10:03,872 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:10:03,873 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:10:03,877 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,877 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,877 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:10:03,877 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:10:03,877 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,877 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:10:03,878 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:10:03,878 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,878 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:10:03,878 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:10:03,878 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,879 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:10:03,879 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:10:03,879 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,879 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,879 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:10:03,879 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,879 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,879 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:10:03,880 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:10:03,880 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:10:03,880 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:10:03,880 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:10:03,880 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,880 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:10:03,881 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,881 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:10:03,882 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:10:03,882 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:03,882 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:10:03,883 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 17:10:03,883 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:10:03,883 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:10:03,883 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:10:03,885 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,887 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:10:03,887 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 17:10:03,887 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:10:03,887 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:10:03,887 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,888 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:10:03,888 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:10:03,888 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:10:03,888 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:10:03,888 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,888 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:10:03,889 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:10:03,889 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:10:03,889 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:10:03,889 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,889 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:10:03,889 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:10:03,889 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:10:03,889 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:10:03,889 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:03,891 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:10:03,891 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 17:10:17,361 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 17:10:17,361 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 17:10:17,361 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 17:10:17,366 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:10:17,367 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:10:17,367 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,367 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,367 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:10:17,367 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:10:17,367 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:10:17,368 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,369 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:10:17,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:10:17,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:10:17,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:10:17,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:10:17,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:10:17,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:10:17,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:10:17,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:10:17,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:10:17,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:10:17,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:10:17,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:10:17,372 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:10:17,372 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:10:17,372 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:10:17,372 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:17,372 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:10:17,373 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:10:17,373 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:10:17,373 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:10:17,373 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,375 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:10:17,375 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:10:17,375 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:10:17,375 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:10:17,376 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:10:17,376 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:10:17,376 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,377 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:10:17,377 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 17:10:17,377 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,378 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 17:10:17,378 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:10:17,378 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:10:17,378 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:10:17,379 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:10:17,379 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 17:10:22,361 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:10:22,361 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:10:22,361 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 17:10:22,361 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:10:22,362 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 17:10:22,362 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:10:22,362 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 17:10:22,362 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:10:22,362 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:10:22,362 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:10:22,363 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:10:22,363 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:10:22,363 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:22,363 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:22,363 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:10:22,365 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:10:22,365 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,366 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,366 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,366 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,366 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 17:10:22,368 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:10:22,368 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,368 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,368 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,368 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,368 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 17:10:22,373 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:10:22,373 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,373 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,373 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:10:22,373 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:10:22,374 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 17:10:27,376 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,376 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,380 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,380 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,383 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,384 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,387 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,387 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,389 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,389 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,393 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,393 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,396 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,396 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,399 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,399 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,401 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,402 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,404 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,404 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,406 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:10:27,407 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:00,447 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 17:16:00,447 - src.api.app - INFO - File watcher stopped
2025-03-30 17:16:08,959 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 17:16:08,959 - __main__ - INFO - Created data folder: data
2025-03-30 17:16:08,960 - __main__ - INFO - Created department folder: data/general
2025-03-30 17:16:08,960 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 17:16:08,960 - __main__ - INFO - Created department folder: data/technical
2025-03-30 17:16:08,960 - __main__ - INFO - Created department folder: data/safety
2025-03-30 17:16:08,960 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 17:16:08,960 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 17:16:08,960 - __main__ - INFO - Found 2 documents in general department
2025-03-30 17:16:08,960 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 17:16:08,960 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 17:16:08,961 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 17:16:08,961 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 17:16:08,961 - __main__ - INFO - Environment: Production
2025-03-30 17:16:09,595 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 17:16:09,595 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 17:16:09,599 - src.api.app - INFO - Initializing LLM service...
2025-03-30 17:16:09,599 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 17:16:09,599 - src.api.app - INFO - Initializing document processor...
2025-03-30 17:16:09,600 - src.api.app - INFO - Initializing document database...
2025-03-30 17:16:09,600 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 17:16:09,600 - src.api.app - INFO - Initializing vector store...
2025-03-30 17:16:09,600 - src.api.app - INFO - Loading vector stores...
2025-03-30 17:16:09,600 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 17:16:09,601 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 17:16:09,640 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 17:16:09,643 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 17:16:09,643 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,643 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 17:16:09,644 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,644 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 17:16:09,644 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,644 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 17:16:09,644 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,644 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 17:16:09,644 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,645 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 17:16:09,645 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,645 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 17:16:09,645 - src.api.app - INFO - Initializing response generator...
2025-03-30 17:16:09,645 - src.api.app - INFO - Initializing file watcher...
2025-03-30 17:16:09,645 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 17:16:09,646 - src.core.file_watcher - INFO - File watcher started
2025-03-30 17:16:09,646 - src.api.app - INFO - File watcher started
2025-03-30 17:16:09,647 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:16:09,647 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:16:09,650 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,650 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,650 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:16:09,650 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:16:09,650 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,651 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:16:09,651 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:16:09,651 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,651 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:16:09,651 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:16:09,652 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,652 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:16:09,652 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:16:09,652 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,652 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,652 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:16:09,653 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:16:09,653 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:16:09,653 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:16:09,653 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,653 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:16:09,654 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:16:09,654 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:16:09,654 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:16:09,654 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:16:09,654 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:16:09,655 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:16:09,655 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:16:09,655 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:16:09,655 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,655 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:16:09,655 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:16:09,656 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 17:16:09,656 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:16:09,656 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:16:09,656 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:16:09,658 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,660 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:16:09,660 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 17:16:09,660 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:16:09,660 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:16:09,660 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,661 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:16:09,661 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:16:09,661 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:16:09,661 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:16:09,661 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,662 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:16:09,662 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:16:09,662 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:16:09,662 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:16:09,662 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,663 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:16:09,663 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:16:09,663 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:16:09,663 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:16:09,663 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:09,664 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:16:09,664 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 17:16:18,096 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 17:16:18,097 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 17:16:18,097 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 17:16:18,102 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:16:18,103 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:16:18,103 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,103 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:16:18,103 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:16:18,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,104 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:16:18,104 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:16:18,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,104 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:16:18,105 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:16:18,105 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,105 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:16:18,105 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:16:18,106 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:16:18,106 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:16:18,106 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:16:18,106 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,106 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:16:18,107 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:16:18,107 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:16:18,107 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:16:18,107 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,107 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:16:18,107 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:16:18,108 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:16:18,108 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:16:18,108 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:16:18,108 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,108 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:16:18,109 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:16:18,109 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:16:18,109 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:16:18,110 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:16:18,110 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:16:18,110 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,113 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:16:18,113 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:16:18,113 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:16:18,113 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,114 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:16:18,114 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:16:18,114 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:16:18,114 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,114 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:16:18,115 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:16:18,115 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:16:18,115 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,115 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:16:18,115 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 17:16:18,115 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,116 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 17:16:18,116 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:16:18,116 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:16:18,116 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:16:18,117 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:16:18,117 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 17:16:23,097 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:16:23,097 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 17:16:23,097 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:16:23,097 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:16:23,097 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:16:23,098 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 17:16:23,098 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:16:23,098 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 17:16:23,098 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:16:23,098 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:23,098 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:16:23,099 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:16:23,099 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:23,099 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:16:23,099 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:16:23,102 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:16:23,102 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,103 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,103 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,103 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,103 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 17:16:23,105 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:16:23,105 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,105 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,105 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,105 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,105 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 17:16:23,108 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:16:23,108 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,108 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,108 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:16:23,108 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:16:23,108 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 17:16:28,114 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,114 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,118 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,118 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,121 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,121 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,124 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,124 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,126 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,127 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,130 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,130 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,133 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,133 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,136 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,136 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,139 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,139 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,142 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,142 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,147 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:16:28,147 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:18,393 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 17:42:18,393 - src.api.app - INFO - File watcher stopped
2025-03-30 17:42:20,101 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 17:42:20,101 - __main__ - INFO - Created data folder: data
2025-03-30 17:42:20,101 - __main__ - INFO - Created department folder: data/general
2025-03-30 17:42:20,101 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 17:42:20,101 - __main__ - INFO - Created department folder: data/technical
2025-03-30 17:42:20,101 - __main__ - INFO - Created department folder: data/safety
2025-03-30 17:42:20,101 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 17:42:20,101 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 17:42:20,101 - __main__ - INFO - Found 2 documents in general department
2025-03-30 17:42:20,102 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 17:42:20,102 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 17:42:20,102 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 17:42:20,102 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 17:42:20,102 - __main__ - INFO - Environment: Production
2025-03-30 17:42:20,731 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 17:42:20,731 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 17:42:20,735 - src.api.app - INFO - Initializing LLM service...
2025-03-30 17:42:20,735 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 17:42:20,735 - src.api.app - INFO - Initializing document processor...
2025-03-30 17:42:20,735 - src.api.app - INFO - Initializing document database...
2025-03-30 17:42:20,736 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 17:42:20,736 - src.api.app - INFO - Initializing vector store...
2025-03-30 17:42:20,736 - src.api.app - INFO - Loading vector stores...
2025-03-30 17:42:20,736 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 17:42:20,737 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 17:42:20,774 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 17:42:20,777 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 17:42:20,777 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,777 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 17:42:20,777 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,778 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 17:42:20,778 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,778 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 17:42:20,778 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,778 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 17:42:20,778 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,778 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 17:42:20,778 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,778 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 17:42:20,778 - src.api.app - INFO - Initializing response generator...
2025-03-30 17:42:20,778 - src.api.app - INFO - Initializing file watcher...
2025-03-30 17:42:20,779 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 17:42:20,780 - src.core.file_watcher - INFO - File watcher started
2025-03-30 17:42:20,780 - src.api.app - INFO - File watcher started
2025-03-30 17:42:20,780 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:42:20,780 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:42:20,783 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,783 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,783 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:42:20,783 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:42:20,783 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,784 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:42:20,784 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:42:20,784 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,784 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:42:20,785 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:42:20,785 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,785 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:42:20,785 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:42:20,786 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:42:20,786 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:42:20,786 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:42:20,786 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:42:20,786 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,786 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:42:20,787 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:42:20,787 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:42:20,787 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:42:20,787 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:42:20,787 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,787 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:42:20,788 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:42:20,788 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:42:20,788 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:42:20,788 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:42:20,788 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,788 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:42:20,789 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:42:20,789 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:20,789 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:42:20,789 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 17:42:20,789 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:42:20,789 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:42:20,789 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:42:20,791 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,793 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:42:20,793 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 17:42:20,794 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:42:20,794 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:42:20,794 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,794 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:42:20,794 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:42:20,794 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:42:20,794 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:42:20,794 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,795 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:42:20,795 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:42:20,795 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:42:20,795 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:42:20,795 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,795 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:42:20,795 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:42:20,796 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:42:20,796 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:42:20,796 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:20,797 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:42:20,797 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 17:42:28,708 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 17:42:28,709 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 17:42:28,709 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 17:42:28,715 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:42:28,715 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:42:28,715 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,715 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:42:28,716 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,717 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:42:28,717 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:42:28,717 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,717 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:42:28,718 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:42:28,718 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:42:28,718 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,718 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:42:28,719 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:42:28,719 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:42:28,719 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:42:28,719 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:42:28,719 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,719 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:42:28,720 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:42:28,720 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:42:28,720 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:42:28,720 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,720 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:42:28,721 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:42:28,721 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:42:28,721 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:28,721 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:42:28,722 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:42:28,722 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:42:28,722 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:42:28,722 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,724 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:42:28,724 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:42:28,724 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:42:28,724 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,725 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:42:28,725 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:42:28,725 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:42:28,725 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,725 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:42:28,725 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:42:28,726 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:42:28,726 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,726 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:42:28,726 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 17:42:28,726 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,727 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 17:42:28,727 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:42:28,727 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:42:28,727 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:42:28,728 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:42:28,728 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 17:42:33,709 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:42:33,709 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 17:42:33,709 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:42:33,709 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:42:33,710 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:42:33,710 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 17:42:33,710 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 17:42:33,710 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:42:33,710 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:42:33,710 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:42:33,710 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:33,711 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:42:33,711 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:33,711 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:42:33,711 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:42:33,713 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:42:33,713 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,713 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,713 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,713 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,713 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 17:42:33,716 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:42:33,716 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,716 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,716 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,716 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,716 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 17:42:33,721 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:42:33,721 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,721 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,721 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:42:33,721 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:42:33,721 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 17:42:38,728 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,728 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,732 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,732 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,735 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,735 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,738 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,738 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,743 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,743 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,746 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,746 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,749 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,749 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,751 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,751 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,753 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,754 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,756 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,756 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,760 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:42:38,760 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:47:43,181 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 17:47:43,181 - src.api.app - INFO - File watcher stopped
2025-03-30 17:47:45,421 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 17:47:45,421 - __main__ - INFO - Created data folder: data
2025-03-30 17:47:45,421 - __main__ - INFO - Created department folder: data/general
2025-03-30 17:47:45,421 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 17:47:45,422 - __main__ - INFO - Created department folder: data/technical
2025-03-30 17:47:45,422 - __main__ - INFO - Created department folder: data/safety
2025-03-30 17:47:45,422 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 17:47:45,422 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 17:47:45,422 - __main__ - INFO - Found 2 documents in general department
2025-03-30 17:47:45,422 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 17:47:45,422 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 17:47:45,422 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 17:47:45,422 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 17:47:45,422 - __main__ - INFO - Environment: Production
2025-03-30 17:47:46,048 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 17:47:46,048 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 17:47:46,052 - src.api.app - INFO - Initializing LLM service...
2025-03-30 17:47:46,052 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 17:47:46,052 - src.api.app - INFO - Initializing document processor...
2025-03-30 17:47:46,052 - src.api.app - INFO - Initializing document database...
2025-03-30 17:47:46,053 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 17:47:46,053 - src.api.app - INFO - Initializing vector store...
2025-03-30 17:47:46,053 - src.api.app - INFO - Loading vector stores...
2025-03-30 17:47:46,053 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 17:47:46,054 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 17:47:46,090 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 17:47:46,093 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 17:47:46,093 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,093 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 17:47:46,093 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,093 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 17:47:46,093 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,094 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 17:47:46,094 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,094 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 17:47:46,094 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,094 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 17:47:46,094 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,094 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 17:47:46,094 - src.api.app - INFO - Initializing response generator...
2025-03-30 17:47:46,094 - src.api.app - INFO - Initializing file watcher...
2025-03-30 17:47:46,095 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 17:47:46,096 - src.core.file_watcher - INFO - File watcher started
2025-03-30 17:47:46,096 - src.api.app - INFO - File watcher started
2025-03-30 17:47:46,097 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:47:46,097 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:47:46,100 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:47:46,100 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,101 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:47:46,101 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:47:46,101 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,101 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:47:46,102 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:47:46,102 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:47:46,102 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:47:46,102 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,102 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:47:46,103 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,103 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:47:46,104 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:47:46,104 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:47:46,104 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:47:46,104 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:47:46,104 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,104 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:47:46,105 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:47:46,105 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:46,105 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:47:46,105 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 17:47:46,105 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:47:46,105 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:47:46,105 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:47:46,107 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,109 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:47:46,109 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 17:47:46,109 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:47:46,109 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:47:46,109 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,110 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:47:46,110 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:47:46,110 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:47:46,110 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:47:46,110 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,111 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:47:46,111 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:47:46,111 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:47:46,111 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:47:46,111 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,111 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:47:46,111 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:47:46,111 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:47:46,112 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:47:46,112 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:46,113 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:47:46,113 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 17:47:52,170 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 17:47:52,170 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 17:47:52,170 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 17:47:52,175 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 17:47:52,176 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 17:47:52,176 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,176 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,176 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 17:47:52,176 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 17:47:52,176 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,177 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:47:52,177 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:47:52,177 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,177 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:47:52,178 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:47:52,178 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,178 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 17:47:52,178 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 17:47:52,179 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 17:47:52,179 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 17:47:52,179 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,179 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 17:47:52,180 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 17:47:52,180 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 17:47:52,180 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,180 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 17:47:52,180 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 17:47:52,181 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 17:47:52,181 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 17:47:52,181 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,181 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 17:47:52,182 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 17:47:52,182 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 17:47:52,182 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 17:47:52,182 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,182 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 17:47:52,183 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 17:47:52,183 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 17:47:52,183 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 17:47:52,184 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 17:47:52,184 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,185 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 17:47:52,186 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 17:47:52,186 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 17:47:52,186 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,186 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 17:47:52,186 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 17:47:52,186 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 17:47:52,186 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,187 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 17:47:52,187 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 17:47:52,187 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 17:47:52,187 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,188 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 17:47:52,188 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 17:47:52,188 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,188 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 17:47:52,188 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 17:47:52,188 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 17:47:52,188 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 17:47:52,189 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 17:47:52,189 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 17:47:57,170 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:47:57,170 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:47:57,170 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 17:47:57,170 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 17:47:57,170 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 17:47:57,171 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 17:47:57,171 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:47:57,171 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 17:47:57,171 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 17:47:57,171 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 17:47:57,171 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:57,172 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 17:47:57,172 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:57,172 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 17:47:57,172 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 17:47:57,174 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:47:57,174 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,175 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,175 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,175 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,175 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 17:47:57,177 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 17:47:57,177 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,177 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,177 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,177 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,177 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 17:47:57,182 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 17:47:57,182 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,182 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,182 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 17:47:57,182 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 17:47:57,183 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 17:48:02,189 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,189 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,192 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,192 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,195 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,195 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,198 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,198 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,201 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,201 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,203 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,203 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,206 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,206 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,208 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,208 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,211 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,211 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,215 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,215 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,218 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 17:48:02,218 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:16,419 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 18:01:16,419 - src.api.app - INFO - File watcher stopped
2025-03-30 18:01:17,827 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 18:01:17,827 - __main__ - INFO - Created data folder: data
2025-03-30 18:01:17,827 - __main__ - INFO - Created department folder: data/general
2025-03-30 18:01:17,827 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 18:01:17,827 - __main__ - INFO - Created department folder: data/technical
2025-03-30 18:01:17,827 - __main__ - INFO - Created department folder: data/safety
2025-03-30 18:01:17,827 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 18:01:17,827 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 18:01:17,827 - __main__ - INFO - Found 2 documents in general department
2025-03-30 18:01:17,827 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 18:01:17,827 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 18:01:17,828 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 18:01:17,828 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 18:01:17,828 - __main__ - INFO - Environment: Production
2025-03-30 18:01:18,456 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 18:01:18,456 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 18:01:18,460 - src.api.app - INFO - Initializing LLM service...
2025-03-30 18:01:18,460 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 18:01:18,460 - src.api.app - INFO - Initializing document processor...
2025-03-30 18:01:18,460 - src.api.app - INFO - Initializing document database...
2025-03-30 18:01:18,461 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 18:01:18,461 - src.api.app - INFO - Initializing vector store...
2025-03-30 18:01:18,461 - src.api.app - INFO - Loading vector stores...
2025-03-30 18:01:18,461 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 18:01:18,462 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 18:01:18,502 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 18:01:18,505 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 18:01:18,505 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,505 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 18:01:18,506 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,506 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 18:01:18,506 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,506 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 18:01:18,506 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,506 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 18:01:18,506 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,506 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 18:01:18,506 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,507 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 18:01:18,507 - src.api.app - INFO - Initializing response generator...
2025-03-30 18:01:18,507 - src.api.app - INFO - Initializing file watcher...
2025-03-30 18:01:18,507 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 18:01:18,508 - src.core.file_watcher - INFO - File watcher started
2025-03-30 18:01:18,508 - src.api.app - INFO - File watcher started
2025-03-30 18:01:18,508 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:01:18,509 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:01:18,511 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,511 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,511 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:01:18,512 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:01:18,512 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,512 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:01:18,512 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:01:18,512 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,513 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:01:18,513 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:01:18,513 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,513 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:01:18,514 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:01:18,514 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:01:18,514 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,514 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:01:18,515 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:01:18,515 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:01:18,515 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:01:18,515 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,515 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:01:18,515 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:01:18,516 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:01:18,516 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:01:18,516 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:01:18,516 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:01:18,516 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,516 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:01:18,517 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:01:18,517 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:18,517 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:01:18,517 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 18:01:18,518 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:01:18,518 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:01:18,518 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:01:18,520 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,522 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:01:18,522 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 18:01:18,522 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:01:18,522 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:01:18,522 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,523 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:01:18,523 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:01:18,523 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:01:18,523 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:01:18,523 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,524 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:01:18,524 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:01:18,524 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:01:18,524 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:01:18,524 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,524 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:01:18,524 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:01:18,524 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:01:18,525 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:01:18,525 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:18,526 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:01:18,526 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 18:01:24,952 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 18:01:24,953 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 18:01:24,953 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 18:01:24,959 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:01:24,960 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:01:24,960 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,960 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,960 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:01:24,960 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:01:24,960 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:01:24,961 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,962 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:01:24,962 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:01:24,962 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:01:24,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:01:24,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:01:24,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:01:24,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:01:24,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:01:24,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:01:24,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:01:24,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:01:24,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:01:24,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:01:24,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:01:24,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:01:24,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:01:24,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:01:24,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:24,967 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:01:24,967 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:01:24,967 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:01:24,967 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:01:24,967 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,971 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:01:24,971 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:01:24,971 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:01:24,971 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,972 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:01:24,972 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:01:24,972 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:01:24,972 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,973 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:01:24,973 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:01:24,973 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:01:24,973 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,974 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:01:24,974 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 18:01:24,974 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,974 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 18:01:24,975 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:01:24,975 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:01:24,975 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:01:24,976 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:01:24,976 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 18:01:29,953 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:01:29,953 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 18:01:29,953 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:01:29,953 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:01:29,953 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:01:29,953 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 18:01:29,953 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:01:29,954 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:29,955 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:01:29,957 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:01:29,957 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,957 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,957 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,957 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,958 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 18:01:29,960 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:01:29,960 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,960 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,960 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,960 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,960 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 18:01:29,965 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:01:29,965 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,965 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,965 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:01:29,965 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:01:29,965 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 18:01:34,971 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,971 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,975 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,975 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,978 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,978 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,981 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,982 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,984 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,984 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,988 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,988 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,991 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,991 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,994 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,994 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,996 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,996 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,999 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:01:34,999 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:01:35,002 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:01:35,002 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:29,074 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 18:04:29,074 - src.api.app - INFO - File watcher stopped
2025-03-30 18:04:30,690 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 18:04:30,690 - __main__ - INFO - Created data folder: data
2025-03-30 18:04:30,690 - __main__ - INFO - Created department folder: data/general
2025-03-30 18:04:30,690 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 18:04:30,690 - __main__ - INFO - Created department folder: data/technical
2025-03-30 18:04:30,690 - __main__ - INFO - Created department folder: data/safety
2025-03-30 18:04:30,690 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 18:04:30,690 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 18:04:30,691 - __main__ - INFO - Found 2 documents in general department
2025-03-30 18:04:30,691 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 18:04:30,691 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 18:04:30,691 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 18:04:30,691 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 18:04:30,691 - __main__ - INFO - Environment: Production
2025-03-30 18:04:31,315 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 18:04:31,316 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 18:04:31,319 - src.api.app - INFO - Initializing LLM service...
2025-03-30 18:04:31,320 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 18:04:31,320 - src.api.app - INFO - Initializing document processor...
2025-03-30 18:04:31,320 - src.api.app - INFO - Initializing document database...
2025-03-30 18:04:31,320 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 18:04:31,320 - src.api.app - INFO - Initializing vector store...
2025-03-30 18:04:31,320 - src.api.app - INFO - Loading vector stores...
2025-03-30 18:04:31,320 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 18:04:31,321 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 18:04:31,362 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 18:04:31,365 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 18:04:31,365 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,365 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 18:04:31,366 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,366 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 18:04:31,366 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,366 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 18:04:31,366 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,366 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 18:04:31,366 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,366 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 18:04:31,366 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,366 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 18:04:31,366 - src.api.app - INFO - Initializing response generator...
2025-03-30 18:04:31,366 - src.api.app - INFO - Initializing file watcher...
2025-03-30 18:04:31,367 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 18:04:31,367 - src.core.file_watcher - INFO - File watcher started
2025-03-30 18:04:31,368 - src.api.app - INFO - File watcher started
2025-03-30 18:04:31,368 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:04:31,369 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:04:31,372 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,372 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,373 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:04:31,373 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:04:31,373 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,373 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:04:31,374 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:04:31,374 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,374 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:04:31,374 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:04:31,374 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,375 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:04:31,375 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:04:31,375 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,375 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,375 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:04:31,375 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:04:31,376 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:04:31,376 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:04:31,376 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,376 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:04:31,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:04:31,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:04:31,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:04:31,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:04:31,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:04:31,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:04:31,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:04:31,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:04:31,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:04:31,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:04:31,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:31,380 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:04:31,380 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 18:04:31,380 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:04:31,380 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:04:31,380 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:04:31,382 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,384 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:04:31,384 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 18:04:31,384 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:04:31,384 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:04:31,384 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,385 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:04:31,385 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:04:31,385 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:04:31,385 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:04:31,385 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,385 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:04:31,386 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:04:31,386 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:04:31,386 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:04:31,386 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,386 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:04:31,386 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:04:31,386 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:04:31,386 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:04:31,386 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:31,388 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:04:31,388 - src.api.app - INFO - Existing documents processed and indexed
2025-03-30 18:04:38,366 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 18:04:38,366 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 18:04:38,367 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 18:04:38,373 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:04:38,373 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:04:38,373 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,374 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,374 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:04:38,374 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:04:38,374 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,374 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:04:38,375 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:04:38,375 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,375 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:04:38,376 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:04:38,376 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,376 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:04:38,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:04:38,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:04:38,377 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,377 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:04:38,378 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,378 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:04:38,379 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:04:38,379 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,380 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:04:38,380 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:04:38,380 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:38,380 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:04:38,380 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:04:38,380 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:04:38,380 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:04:38,380 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:04:38,382 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:04:38,382 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:04:38,383 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,383 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:04:38,383 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:04:38,383 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:04:38,383 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,383 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:04:38,384 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 18:04:38,384 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,384 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 18:04:38,384 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:04:38,384 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:04:38,384 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:04:38,385 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:04:38,386 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 18:04:43,367 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:04:43,367 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 18:04:43,367 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:04:43,367 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:04:43,367 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:04:43,367 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 18:04:43,367 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:04:43,368 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:43,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:04:43,370 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:04:43,370 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,371 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,371 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,371 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,371 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 18:04:43,374 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:04:43,374 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,374 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,374 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,374 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,374 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 18:04:43,379 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:04:43,379 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,379 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 209, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,379 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:04:43,379 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 243, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:04:43,379 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 18:04:48,384 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,384 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,389 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,389 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,393 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,393 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,397 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,397 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,400 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,400 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,403 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,403 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,408 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,408 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,412 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,412 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,417 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,417 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,422 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,423 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,428 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:04:48,428 - src.core.vector_store - ERROR - Fallback similarity search also failed: 'MockEmbeddings' object is not callable
2025-03-30 18:29:14,772 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 18:29:14,772 - src.api.app - INFO - File watcher stopped
2025-03-30 18:29:15,731 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 18:29:15,731 - __main__ - INFO - Created data folder: data
2025-03-30 18:29:15,731 - __main__ - INFO - Created department folder: data/general
2025-03-30 18:29:15,731 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 18:29:15,731 - __main__ - INFO - Created department folder: data/technical
2025-03-30 18:29:15,732 - __main__ - INFO - Created department folder: data/safety
2025-03-30 18:29:15,732 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 18:29:15,732 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 18:29:15,732 - __main__ - INFO - Found 2 documents in general department
2025-03-30 18:29:15,732 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 18:29:15,732 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 18:29:15,732 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 18:29:15,732 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 18:29:15,732 - __main__ - INFO - Environment: Production
2025-03-30 18:31:50,555 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-03-30 18:31:50,555 - __main__ - INFO - Created data folder: data
2025-03-30 18:31:50,555 - __main__ - INFO - Created department folder: data/general
2025-03-30 18:31:50,555 - __main__ - INFO - Created department folder: data/commercial
2025-03-30 18:31:50,555 - __main__ - INFO - Created department folder: data/technical
2025-03-30 18:31:50,555 - __main__ - INFO - Created department folder: data/safety
2025-03-30 18:31:50,555 - __main__ - INFO - Created department folder: data/regulatory
2025-03-30 18:31:50,555 - __main__ - INFO - Created vector store directory: faiss_index
2025-03-30 18:31:50,555 - __main__ - INFO - Found 2 documents in general department
2025-03-30 18:31:50,556 - __main__ - INFO - Found 1 documents in commercial department
2025-03-30 18:31:50,556 - __main__ - INFO - Found 1 documents in technical department
2025-03-30 18:31:50,556 - __main__ - INFO - Found 16 documents in regulatory department
2025-03-30 18:31:50,556 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-03-30 18:31:50,556 - __main__ - INFO - Environment: Production
2025-03-30 18:31:51,156 - src.api.app - INFO - Initializing embeddings model...
2025-03-30 18:31:51,156 - src.utils.embeddings - INFO - Using mock embeddings
2025-03-30 18:31:51,160 - src.api.app - INFO - Initializing LLM service...
2025-03-30 18:31:51,160 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-03-30 18:31:51,160 - src.api.app - INFO - Initializing document processor...
2025-03-30 18:31:51,160 - src.api.app - INFO - Initializing document database...
2025-03-30 18:31:51,161 - src.core.document_database - INFO - Document database initialized at documents.db
2025-03-30 18:31:51,161 - src.api.app - INFO - Initializing vector store...
2025-03-30 18:31:51,161 - src.api.app - INFO - Loading vector stores...
2025-03-30 18:31:51,161 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-03-30 18:31:51,162 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-03-30 18:31:51,199 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-03-30 18:31:51,201 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,202 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,202 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,202 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,202 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,202 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-03-30 18:31:51,202 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,203 - src.api.app - INFO - Successfully initialized vector stores
2025-03-30 18:31:51,203 - src.api.app - INFO - Initializing response generator...
2025-03-30 18:31:51,203 - src.api.app - INFO - Initializing file watcher...
2025-03-30 18:31:51,203 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-03-30 18:31:51,204 - src.core.file_watcher - INFO - File watcher started
2025-03-30 18:31:51,204 - src.api.app - INFO - File watcher started
2025-03-30 18:31:51,204 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:31:51,205 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:31:51,208 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,208 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,208 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:31:51,208 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:31:51,208 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,208 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:31:51,209 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:31:51,209 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,209 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:31:51,209 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:31:51,209 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,209 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:31:51,210 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:31:51,210 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:31:51,210 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,210 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:31:51,210 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:31:51,211 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:31:51,211 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:31:51,211 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:31:51,211 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:31:51,211 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,211 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:31:51,212 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,212 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:31:51,213 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:31:51,213 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:51,213 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:31:51,213 - src.api.app - INFO - Found 20 existing documents to process
2025-03-30 18:31:51,213 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:31:51,213 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:31:51,213 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:31:51,215 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,217 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:31:51,217 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-03-30 18:31:51,217 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:31:51,217 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:31:51,217 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,217 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:31:51,217 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:31:51,218 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:31:51,218 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:31:51,218 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,218 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:31:51,218 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:31:51,218 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:31:51,218 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:31:51,218 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,219 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:31:51,219 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:31:51,219 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:31:51,219 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:31:51,219 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:51,220 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:31:51,220 - src.api.app - INFO - Successfully processed 20 documents into 28 chunks
2025-03-30 18:31:51,220 - src.api.app - INFO - Vector store status: {'main_index': {'exists': True, 'size': 28}, 'department_indexes': {'general': {'exists': True, 'size': 2}, 'commercial': {'exists': True, 'size': 5}, 'technical': {'exists': True, 'size': 3}, 'safety': {'exists': True, 'size': 1}, 'regulatory': {'exists': True, 'size': 18}}, 'total_documents': 57}
2025-03-30 18:31:58,460 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-03-30 18:31:58,460 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-03-30 18:31:58,460 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-03-30 18:31:58,465 - src.core.document_processor - WARNING - No supported document files found in data
2025-03-30 18:31:58,465 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-03-30 18:31:58,466 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,466 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,466 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-03-30 18:31:58,466 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-03-30 18:31:58,466 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,466 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:31:58,467 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:31:58,467 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,467 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:31:58,467 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:31:58,467 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,467 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-03-30 18:31:58,468 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-03-30 18:31:58,468 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,468 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,468 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-03-30 18:31:58,468 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,468 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-03-30 18:31:58,469 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-03-30 18:31:58,469 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-03-30 18:31:58,469 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,469 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-03-30 18:31:58,469 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-03-30 18:31:58,470 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-03-30 18:31:58,470 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-03-30 18:31:58,470 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,470 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-03-30 18:31:58,471 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-03-30 18:31:58,471 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-03-30 18:31:58,471 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-03-30 18:31:58,471 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,471 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-03-30 18:31:58,472 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-03-30 18:31:58,472 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:31:58,472 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-03-30 18:31:58,473 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-03-30 18:31:58,473 - src.core.vector_store - INFO - Creating new FAISS index...
2025-03-30 18:31:58,473 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-03-30 18:31:58,473 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-03-30 18:31:58,475 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-03-30 18:31:58,475 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-03-30 18:31:58,475 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,476 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-03-30 18:31:58,476 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-03-30 18:31:58,476 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-03-30 18:31:58,476 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,476 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-03-30 18:31:58,476 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-03-30 18:31:58,477 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,477 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-03-30 18:31:58,477 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-03-30 18:31:58,477 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-03-30 18:31:58,477 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-03-30 18:31:58,478 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-03-30 18:31:58,478 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-03-30 18:32:03,460 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:32:03,460 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:32:03,460 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-03-30 18:32:03,460 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:32:03,461 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-03-30 18:32:03,461 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-03-30 18:32:03,461 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-03-30 18:32:03,461 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-03-30 18:32:03,461 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-03-30 18:32:03,461 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-03-30 18:32:03,461 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:32:03,462 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-03-30 18:32:03,462 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-03-30 18:32:03,462 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:32:03,462 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-03-30 18:32:03,464 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:32:03,464 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,465 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,465 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,465 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,465 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-03-30 18:32:03,467 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-03-30 18:32:03,467 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,467 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,467 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,467 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,467 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-03-30 18:32:03,472 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-03-30 18:32:03,472 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,472 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,472 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-03-30 18:32:03,473 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-03-30 18:32:03,473 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-03-30 18:32:08,477 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,477 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,477 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-03-30 18:32:08,482 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,482 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,482 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-03-30 18:32:08,485 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,485 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,485 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-03-30 18:32:08,489 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,489 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,489 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-03-30 18:32:08,493 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,493 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,493 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-03-30 18:32:08,496 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,496 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,496 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-03-30 18:32:08,499 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,499 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,499 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-03-30 18:32:08,503 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,503 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,503 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-03-30 18:32:08,506 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,506 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,506 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-03-30 18:32:08,509 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,510 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,510 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-03-30 18:32:08,513 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,513 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-03-30 18:32:08,513 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-03-30 18:34:58,642 - src.core.file_watcher - INFO - File watcher stopped
2025-03-30 18:34:58,642 - src.api.app - INFO - File watcher stopped
2025-04-03 02:37:58,086 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-04-03 02:37:58,087 - __main__ - INFO - Created data folder: data
2025-04-03 02:37:58,087 - __main__ - INFO - Created department folder: data/general
2025-04-03 02:37:58,087 - __main__ - INFO - Created department folder: data/commercial
2025-04-03 02:37:58,087 - __main__ - INFO - Created department folder: data/technical
2025-04-03 02:37:58,087 - __main__ - INFO - Created department folder: data/safety
2025-04-03 02:37:58,087 - __main__ - INFO - Created department folder: data/regulatory
2025-04-03 02:37:58,087 - __main__ - INFO - Created vector store directory: faiss_index
2025-04-03 02:37:58,087 - __main__ - INFO - Found 2 documents in general department
2025-04-03 02:37:58,087 - __main__ - INFO - Found 1 documents in commercial department
2025-04-03 02:37:58,087 - __main__ - INFO - Found 1 documents in technical department
2025-04-03 02:37:58,087 - __main__ - INFO - Found 16 documents in regulatory department
2025-04-03 02:37:58,087 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-04-03 02:37:58,087 - __main__ - INFO - Environment: Production
2025-04-03 02:38:12,305 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-04-03 02:38:12,305 - __main__ - INFO - Created data folder: data
2025-04-03 02:38:12,305 - __main__ - INFO - Created department folder: data/general
2025-04-03 02:38:12,306 - __main__ - INFO - Created department folder: data/commercial
2025-04-03 02:38:12,306 - __main__ - INFO - Created department folder: data/technical
2025-04-03 02:38:12,306 - __main__ - INFO - Created department folder: data/safety
2025-04-03 02:38:12,306 - __main__ - INFO - Created department folder: data/regulatory
2025-04-03 02:38:12,306 - __main__ - INFO - Created vector store directory: faiss_index
2025-04-03 02:38:12,306 - __main__ - INFO - Found 2 documents in general department
2025-04-03 02:38:12,306 - __main__ - INFO - Found 1 documents in commercial department
2025-04-03 02:38:12,306 - __main__ - INFO - Found 1 documents in technical department
2025-04-03 02:38:12,306 - __main__ - INFO - Found 16 documents in regulatory department
2025-04-03 02:38:12,306 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-04-03 02:38:12,306 - __main__ - INFO - Environment: Production
2025-04-03 02:38:12,910 - src.api.app - INFO - Initializing embeddings model...
2025-04-03 02:38:12,910 - src.utils.embeddings - INFO - Using mock embeddings
2025-04-03 02:38:12,914 - src.api.app - INFO - Initializing LLM service...
2025-04-03 02:38:12,914 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-04-03 02:38:12,914 - src.api.app - INFO - Initializing document processor...
2025-04-03 02:38:12,914 - src.api.app - INFO - Initializing document database...
2025-04-03 02:38:12,914 - src.core.document_database - INFO - Document database initialized at documents.db
2025-04-03 02:38:12,914 - src.api.app - INFO - Initializing vector store...
2025-04-03 02:38:12,914 - src.api.app - INFO - Loading vector stores...
2025-04-03 02:38:12,914 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-04-03 02:38:12,915 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-03 02:38:12,951 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-03 02:38:12,954 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-03 02:38:12,954 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,954 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-04-03 02:38:12,954 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,954 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-04-03 02:38:12,955 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,955 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-04-03 02:38:12,955 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,955 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-04-03 02:38:12,955 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,955 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-04-03 02:38:12,955 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,955 - src.api.app - INFO - Successfully initialized vector stores
2025-04-03 02:38:12,955 - src.api.app - INFO - Initializing response generator...
2025-04-03 02:38:12,955 - src.api.app - INFO - Initializing file watcher...
2025-04-03 02:38:12,955 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-04-03 02:38:12,956 - src.core.file_watcher - INFO - File watcher started
2025-04-03 02:38:12,956 - src.api.app - INFO - File watcher started
2025-04-03 02:38:12,957 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:38:12,957 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:38:12,960 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,960 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,960 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:38:12,960 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:38:12,960 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:38:12,961 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,962 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:38:12,962 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:38:12,962 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:38:12,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:38:12,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:38:12,963 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,963 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:38:12,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:38:12,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:38:12,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:38:12,964 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,964 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:38:12,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:38:12,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:38:12,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:38:12,965 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,965 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:38:12,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:38:12,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:38:12,966 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:38:12,966 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:38:12,967 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:12,967 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-04-03 02:38:12,967 - src.api.app - INFO - Found 20 existing documents to process
2025-04-03 02:38:12,967 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-04-03 02:38:12,967 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:38:12,967 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-04-03 02:38:12,969 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,971 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:38:12,971 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-04-03 02:38:12,971 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:38:12,971 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-04-03 02:38:12,971 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,972 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:38:12,972 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:38:12,972 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:38:12,972 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:38:12,972 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,973 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:38:12,973 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:38:12,973 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:38:12,973 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:38:12,973 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,973 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:38:12,973 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:38:12,974 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:38:12,974 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-04-03 02:38:12,974 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:12,975 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:38:12,975 - src.api.app - INFO - Successfully processed 20 documents into 28 chunks
2025-04-03 02:38:12,975 - src.api.app - INFO - Vector store status: {'main_index': {'exists': True, 'size': 28}, 'department_indexes': {'general': {'exists': True, 'size': 2}, 'commercial': {'exists': True, 'size': 5}, 'technical': {'exists': True, 'size': 3}, 'safety': {'exists': True, 'size': 1}, 'regulatory': {'exists': True, 'size': 18}}, 'total_documents': 57}
2025-04-03 02:38:39,908 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-04-03 02:38:39,908 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-04-03 02:38:39,908 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-04-03 02:38:39,913 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:38:39,914 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:38:39,914 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,914 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,914 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:38:39,914 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:38:39,914 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:38:39,915 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,916 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:38:39,916 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:38:39,916 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,916 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,916 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:38:39,916 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,916 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,916 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:38:39,917 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:38:39,917 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:38:39,917 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:38:39,917 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:38:39,917 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,917 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:38:39,918 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:38:39,918 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:38:39,918 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:38:39,918 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:38:39,918 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,918 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:38:39,919 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:38:39,919 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:38:39,919 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:39,919 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-04-03 02:38:39,920 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-04-03 02:38:39,920 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:38:39,920 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-04-03 02:38:39,920 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-04-03 02:38:39,922 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:38:39,922 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:38:39,922 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,923 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:38:39,923 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:38:39,923 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:38:39,923 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,923 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:38:39,923 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-04-03 02:38:39,923 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,924 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-04-03 02:38:39,924 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:38:39,924 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-04-03 02:38:39,924 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:38:39,925 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:38:39,926 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-04-03 02:38:44,908 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:38:44,909 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:38:44,909 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:38:44,909 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-04-03 02:38:44,909 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-04-03 02:38:44,909 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:38:44,909 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-04-03 02:38:44,909 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:38:44,909 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:44,910 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:38:44,912 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:38:44,913 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,913 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,913 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,913 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,913 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-04-03 02:38:44,915 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:38:44,915 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,915 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,916 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,916 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,916 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-04-03 02:38:44,920 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:38:44,920 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,921 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,921 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:38:44,921 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:38:44,921 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-04-03 02:38:49,926 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,926 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,926 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:38:49,931 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,931 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,932 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:38:49,937 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,937 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,937 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:38:49,941 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,941 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,941 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:38:49,944 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,944 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,944 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:38:49,947 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,947 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,947 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:38:49,950 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,950 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,950 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:38:49,955 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,955 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,955 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:38:49,958 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,958 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,958 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:38:49,961 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,961 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,961 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:38:49,964 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,964 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:38:49,964 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:39:29,989 - src.core.file_watcher - INFO - File watcher stopped
2025-04-03 02:39:29,989 - src.api.app - INFO - File watcher stopped
2025-04-03 02:39:47,288 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-04-03 02:39:47,288 - __main__ - INFO - Created data folder: data
2025-04-03 02:39:47,288 - __main__ - INFO - Created department folder: data/general
2025-04-03 02:39:47,288 - __main__ - INFO - Created department folder: data/commercial
2025-04-03 02:39:47,288 - __main__ - INFO - Created department folder: data/technical
2025-04-03 02:39:47,288 - __main__ - INFO - Created department folder: data/safety
2025-04-03 02:39:47,288 - __main__ - INFO - Created department folder: data/regulatory
2025-04-03 02:39:47,288 - __main__ - INFO - Created vector store directory: faiss_index
2025-04-03 02:39:47,288 - __main__ - INFO - Found 2 documents in general department
2025-04-03 02:39:47,288 - __main__ - INFO - Found 1 documents in commercial department
2025-04-03 02:39:47,288 - __main__ - INFO - Found 1 documents in technical department
2025-04-03 02:39:47,288 - __main__ - INFO - Found 16 documents in regulatory department
2025-04-03 02:39:47,288 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-04-03 02:39:47,288 - __main__ - INFO - Environment: Production
2025-04-03 02:39:47,887 - src.api.app - INFO - Initializing embeddings model...
2025-04-03 02:39:47,887 - src.utils.embeddings - INFO - Using mock embeddings
2025-04-03 02:39:47,891 - src.api.app - INFO - Initializing LLM service...
2025-04-03 02:39:47,892 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-04-03 02:39:47,892 - src.api.app - INFO - Initializing document processor...
2025-04-03 02:39:47,892 - src.api.app - INFO - Initializing document database...
2025-04-03 02:39:47,892 - src.core.document_database - INFO - Document database initialized at documents.db
2025-04-03 02:39:47,892 - src.api.app - INFO - Initializing vector store...
2025-04-03 02:39:47,892 - src.api.app - INFO - Loading vector stores...
2025-04-03 02:39:47,892 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-04-03 02:39:47,893 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-03 02:39:47,932 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-03 02:39:47,935 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-03 02:39:47,936 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,936 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-04-03 02:39:47,936 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,936 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-04-03 02:39:47,936 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,936 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-04-03 02:39:47,936 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,936 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-04-03 02:39:47,937 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,937 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-04-03 02:39:47,937 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,937 - src.api.app - INFO - Successfully initialized vector stores
2025-04-03 02:39:47,937 - src.api.app - INFO - Initializing response generator...
2025-04-03 02:39:47,937 - src.api.app - INFO - Initializing file watcher...
2025-04-03 02:39:47,937 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-04-03 02:39:47,938 - src.core.file_watcher - INFO - File watcher started
2025-04-03 02:39:47,938 - src.api.app - INFO - File watcher started
2025-04-03 02:39:47,939 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:39:47,939 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:39:47,942 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,942 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,942 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:39:47,942 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:39:47,942 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,943 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:39:47,943 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:39:47,943 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,943 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:39:47,944 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:39:47,944 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,944 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:39:47,944 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:39:47,945 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:39:47,945 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:39:47,945 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:39:47,945 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,945 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:39:47,945 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:39:47,946 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:39:47,946 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:39:47,946 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:39:47,946 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,946 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:39:47,947 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:39:47,947 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:39:47,947 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:39:47,947 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,947 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:39:47,948 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:39:47,948 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:47,948 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-04-03 02:39:47,948 - src.api.app - INFO - Found 20 existing documents to process
2025-04-03 02:39:47,949 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-04-03 02:39:47,949 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:39:47,949 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-04-03 02:39:47,951 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,954 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:39:47,954 - src.core.document_processor - INFO - Split 1 documents into 1 chunks
2025-04-03 02:39:47,954 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:39:47,954 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-04-03 02:39:47,954 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,955 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:39:47,955 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:39:47,955 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:39:47,955 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:39:47,955 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,955 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:39:47,956 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:39:47,956 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:39:47,956 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:39:47,956 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,956 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:39:47,956 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:39:47,956 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:39:47,956 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-04-03 02:39:47,956 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:47,957 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:39:47,957 - src.api.app - INFO - Successfully processed 20 documents into 28 chunks
2025-04-03 02:39:47,958 - src.api.app - INFO - Vector store status: {'main_index': {'exists': True, 'size': 28}, 'department_indexes': {'general': {'exists': True, 'size': 2}, 'commercial': {'exists': True, 'size': 5}, 'technical': {'exists': True, 'size': 3}, 'safety': {'exists': True, 'size': 1}, 'regulatory': {'exists': True, 'size': 18}}, 'total_documents': 57}
2025-04-03 02:39:55,359 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-04-03 02:39:55,360 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-04-03 02:39:55,360 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-04-03 02:39:55,365 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:39:55,365 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:39:55,366 - src.core.document_processor - ERROR - Error loading PDF data/general/StrategiePortuaire_a_lhorizon_2030.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,366 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,366 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:39:55,366 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:39:55,366 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,366 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:39:55,367 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:39:55,367 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,367 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:39:55,367 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:39:55,367 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,367 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:39:55,368 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:39:55,368 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,368 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,368 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:39:55,368 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:39:55,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1918_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:39:55,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_n1-95-1.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:39:55,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Dakhla.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:39:55,369 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Nador.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,369 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Safi.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Tantan.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Dahir_1914_Fr.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Code_ISPS.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Loi n71-18 .pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,370 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:39:55,370 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Laayoune.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:39:55,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:39:55,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:39:55,371 - src.core.document_processor - ERROR - Error loading PDF data/regulatory/Reglement_dexploitation_port_Agadir.pdf: `pypdf` package not found, please install it with `pip install pypdf`
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:39:55,371 - src.core.document_processor - INFO - Loaded 20 total documents from all folders
2025-04-03 02:39:55,372 - src.core.document_processor - INFO - Split 4 documents into 12 chunks
2025-04-03 02:39:55,372 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:39:55,372 - src.core.vector_store - INFO - Creating vectorstore from 28 chunks
2025-04-03 02:39:55,372 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Creating vectorstore for department general from 2 chunks
2025-04-03 02:39:55,374 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:39:55,374 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:39:55,374 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,375 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:39:55,375 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:39:55,375 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:39:55,375 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,375 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:39:55,375 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-04-03 02:39:55,375 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,376 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-04-03 02:39:55,376 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:39:55,376 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 18 chunks
2025-04-03 02:39:55,376 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:39:55,377 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:39:55,377 - src.api.endpoints - INFO - Successfully rebuilt indexes with 28 chunks from 20 documents
2025-04-03 02:40:00,360 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:40:00,360 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:40:00,360 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:40:00,361 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-04-03 02:40:00,361 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-04-03 02:40:00,361 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-04-03 02:40:00,361 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:40:00,361 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:40:00,361 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:40:00,361 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:40:00,362 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:40:00,362 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:40:00,362 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:40:00,362 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:40:00,362 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:40:00,364 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:40:00,364 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,365 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,365 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,365 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,365 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-04-03 02:40:00,367 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:40:00,367 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,367 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,367 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,367 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,367 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-04-03 02:40:00,372 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:40:00,372 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,372 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,372 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:40:00,373 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:40:00,373 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-04-03 02:40:05,376 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,376 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,376 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:40:05,381 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,381 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,381 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:40:05,384 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,384 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,385 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:40:05,389 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,389 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,389 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:40:05,392 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,392 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,392 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:40:05,395 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,395 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,395 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:40:05,399 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,399 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,399 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:40:05,403 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,403 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,403 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:40:05,406 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,406 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,406 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:40:05,410 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,410 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,410 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:40:05,413 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,413 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:40:05,413 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:41:15,800 - src.core.file_watcher - INFO - File watcher stopped
2025-04-03 02:41:15,800 - src.api.app - INFO - File watcher stopped
2025-04-03 02:41:23,447 - __main__ - INFO - Loaded configuration from config/config.yaml
2025-04-03 02:41:23,447 - __main__ - INFO - Created data folder: data
2025-04-03 02:41:23,447 - __main__ - INFO - Created department folder: data/general
2025-04-03 02:41:23,447 - __main__ - INFO - Created department folder: data/commercial
2025-04-03 02:41:23,447 - __main__ - INFO - Created department folder: data/technical
2025-04-03 02:41:23,448 - __main__ - INFO - Created department folder: data/safety
2025-04-03 02:41:23,448 - __main__ - INFO - Created department folder: data/regulatory
2025-04-03 02:41:23,448 - __main__ - INFO - Created vector store directory: faiss_index
2025-04-03 02:41:23,448 - __main__ - INFO - Found 2 documents in general department
2025-04-03 02:41:23,448 - __main__ - INFO - Found 1 documents in commercial department
2025-04-03 02:41:23,448 - __main__ - INFO - Found 1 documents in technical department
2025-04-03 02:41:23,448 - __main__ - INFO - Found 16 documents in regulatory department
2025-04-03 02:41:23,448 - __main__ - INFO - Starting RAG service on 0.0.0.0:8001
2025-04-03 02:41:23,448 - __main__ - INFO - Environment: Production
2025-04-03 02:41:24,041 - src.api.app - INFO - Initializing embeddings model...
2025-04-03 02:41:24,041 - src.utils.embeddings - INFO - Using mock embeddings
2025-04-03 02:41:24,044 - src.api.app - INFO - Initializing LLM service...
2025-04-03 02:41:24,044 - src.utils.llm - INFO - Using mock LLM for development/testing
2025-04-03 02:41:24,044 - src.api.app - INFO - Initializing document processor...
2025-04-03 02:41:24,044 - src.api.app - INFO - Initializing document database...
2025-04-03 02:41:24,045 - src.core.document_database - INFO - Document database initialized at documents.db
2025-04-03 02:41:24,045 - src.api.app - INFO - Initializing vector store...
2025-04-03 02:41:24,045 - src.api.app - INFO - Loading vector stores...
2025-04-03 02:41:24,045 - src.core.vector_store - INFO - Loading existing FAISS index...
2025-04-03 02:41:24,046 - faiss.loader - INFO - Loading faiss with AVX2 support.
2025-04-03 02:41:24,084 - faiss.loader - INFO - Successfully loaded faiss with AVX2 support.
2025-04-03 02:41:24,087 - faiss - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-03 02:41:24,088 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,088 - src.core.vector_store - INFO - Loading existing FAISS index for department: general...
2025-04-03 02:41:24,088 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,088 - src.core.vector_store - INFO - Loading existing FAISS index for department: commercial...
2025-04-03 02:41:24,088 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,088 - src.core.vector_store - INFO - Loading existing FAISS index for department: technical...
2025-04-03 02:41:24,088 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,088 - src.core.vector_store - INFO - Loading existing FAISS index for department: safety...
2025-04-03 02:41:24,088 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,088 - src.core.vector_store - INFO - Loading existing FAISS index for department: regulatory...
2025-04-03 02:41:24,089 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:24,089 - src.api.app - INFO - Successfully initialized vector stores
2025-04-03 02:41:24,089 - src.api.app - INFO - Initializing response generator...
2025-04-03 02:41:24,089 - src.api.app - INFO - Initializing file watcher...
2025-04-03 02:41:24,089 - src.core.file_watcher - INFO - File watcher set up for directory: data
2025-04-03 02:41:24,090 - src.core.file_watcher - INFO - File watcher started
2025-04-03 02:41:24,090 - src.api.app - INFO - File watcher started
2025-04-03 02:41:24,090 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:41:24,091 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:41:24,652 - src.core.document_processor - INFO - Successfully loaded PDF with 62 pages
2025-04-03 02:41:24,653 - src.core.document_processor - INFO - Loaded document with 62 sections/pages
2025-04-03 02:41:24,653 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:41:24,653 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:41:24,653 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:41:24,654 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:41:24,655 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:41:24,655 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:41:27,116 - src.core.document_processor - INFO - Successfully loaded PDF with 77 pages
2025-04-03 02:41:27,117 - src.core.document_processor - INFO - Loaded document with 77 sections/pages
2025-04-03 02:41:27,117 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:41:29,621 - src.core.document_processor - INFO - Successfully loaded PDF with 80 pages
2025-04-03 02:41:29,621 - src.core.document_processor - INFO - Loaded document with 80 sections/pages
2025-04-03 02:41:29,621 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:41:29,651 - src.core.document_processor - INFO - Successfully loaded PDF with 4 pages
2025-04-03 02:41:29,651 - src.core.document_processor - INFO - Loaded document with 4 sections/pages
2025-04-03 02:41:29,651 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:41:29,654 - src.core.document_processor - INFO - Successfully loaded PDF with 5 pages
2025-04-03 02:41:29,654 - src.core.document_processor - INFO - Loaded document with 5 sections/pages
2025-04-03 02:41:29,654 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:41:32,166 - src.core.document_processor - INFO - Successfully loaded PDF with 81 pages
2025-04-03 02:41:32,166 - src.core.document_processor - INFO - Loaded document with 81 sections/pages
2025-04-03 02:41:32,166 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:41:34,761 - src.core.document_processor - INFO - Successfully loaded PDF with 82 pages
2025-04-03 02:41:34,762 - src.core.document_processor - INFO - Loaded document with 82 sections/pages
2025-04-03 02:41:34,762 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:41:37,246 - src.core.document_processor - INFO - Successfully loaded PDF with 78 pages
2025-04-03 02:41:37,247 - src.core.document_processor - INFO - Loaded document with 78 sections/pages
2025-04-03 02:41:37,247 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:41:40,962 - src.core.document_processor - INFO - Successfully loaded PDF with 80 pages
2025-04-03 02:41:40,962 - src.core.document_processor - INFO - Loaded document with 80 sections/pages
2025-04-03 02:41:40,962 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:41:40,982 - src.core.document_processor - INFO - Successfully loaded PDF with 3 pages
2025-04-03 02:41:40,982 - src.core.document_processor - INFO - Loaded document with 3 sections/pages
2025-04-03 02:41:40,982 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:41:41,659 - src.core.document_processor - INFO - Successfully loaded PDF with 113 pages
2025-04-03 02:41:41,659 - src.core.document_processor - INFO - Loaded document with 113 sections/pages
2025-04-03 02:41:41,659 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:41:42,393 - src.core.document_processor - INFO - Successfully loaded PDF with 15 pages
2025-04-03 02:41:42,393 - src.core.document_processor - INFO - Loaded document with 15 sections/pages
2025-04-03 02:41:42,393 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:41:44,856 - src.core.document_processor - INFO - Successfully loaded PDF with 78 pages
2025-04-03 02:41:44,856 - src.core.document_processor - INFO - Loaded document with 78 sections/pages
2025-04-03 02:41:44,856 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:41:46,439 - src.core.document_processor - INFO - Successfully loaded PDF with 70 pages
2025-04-03 02:41:46,439 - src.core.document_processor - INFO - Loaded document with 70 sections/pages
2025-04-03 02:41:46,439 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:41:49,684 - src.core.document_processor - INFO - Successfully loaded PDF with 102 pages
2025-04-03 02:41:49,684 - src.core.document_processor - INFO - Loaded document with 102 sections/pages
2025-04-03 02:41:49,684 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:41:52,544 - src.core.document_processor - INFO - Successfully loaded PDF with 91 pages
2025-04-03 02:41:52,544 - src.core.document_processor - INFO - Loaded document with 91 sections/pages
2025-04-03 02:41:52,544 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:41:52,545 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:41:52,545 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:41:52,545 - src.core.document_processor - INFO - Loaded 1025 total documents from all folders
2025-04-03 02:41:52,545 - src.api.app - INFO - Found 1025 existing documents to process
2025-04-03 02:41:52,640 - src.core.document_processor - INFO - Split 1025 documents into 3691 chunks
2025-04-03 02:41:52,641 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:41:52,641 - src.core.vector_store - INFO - Creating vectorstore from 3691 chunks
2025-04-03 02:41:53,132 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:53,491 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:41:53,495 - src.core.document_processor - INFO - Split 63 documents into 137 chunks
2025-04-03 02:41:53,495 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:41:53,495 - src.core.vector_store - INFO - Creating vectorstore for department general from 137 chunks
2025-04-03 02:41:53,495 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:53,502 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:41:53,502 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:41:53,503 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:41:53,503 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:41:53,503 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:53,503 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:41:53,504 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:41:53,504 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:41:53,504 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:41:53,504 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:53,504 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:41:53,591 - src.core.document_processor - INFO - Split 960 documents into 3546 chunks
2025-04-03 02:41:53,591 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:41:53,592 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 3546 chunks
2025-04-03 02:41:53,596 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:41:53,767 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:41:53,767 - src.api.app - INFO - Successfully processed 1025 documents into 3691 chunks
2025-04-03 02:41:53,767 - src.api.app - INFO - Vector store status: {'main_index': {'exists': True, 'size': 3691}, 'department_indexes': {'general': {'exists': True, 'size': 137}, 'commercial': {'exists': True, 'size': 5}, 'technical': {'exists': True, 'size': 3}, 'safety': {'exists': True, 'size': 1}, 'regulatory': {'exists': True, 'size': 3546}}, 'total_documents': 7383}
2025-04-03 02:42:03,508 - src.core.file_watcher - INFO - Modified file detected: data/regulatory/port_regulations.txt
2025-04-03 02:42:03,508 - src.core.file_watcher - INFO - Modified file detected: data/technical/equipment_specifications.txt
2025-04-03 02:42:03,508 - src.core.file_watcher - INFO - Modified file detected: data/commercial/port_tariffs.txt
2025-04-03 02:42:03,513 - src.core.document_processor - WARNING - No supported document files found in data
2025-04-03 02:42:03,514 - src.core.document_processor - INFO - Processing file: data/general/StrategiePortuaire_a_lhorizon_2030.pdf
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Successfully loaded PDF with 62 pages
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Loaded document with 62 sections/pages
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Processing file: data/general/test_document.txt
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Successfully loaded text file with 649 characters
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:42:04,059 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:42:04,060 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:04,060 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:42:04,060 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:42:04,061 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:04,061 - src.core.document_processor - WARNING - No supported document files found in data/safety
2025-04-03 02:42:04,061 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_JorfLasfar.pdf
2025-04-03 02:42:06,687 - src.core.document_processor - INFO - Successfully loaded PDF with 77 pages
2025-04-03 02:42:06,687 - src.core.document_processor - INFO - Loaded document with 77 sections/pages
2025-04-03 02:42:06,687 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Alhoceima.pdf
2025-04-03 02:42:08,511 - src.core.file_watcher - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:42:08,511 - src.core.file_watcher - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:42:08,511 - src.core.file_watcher - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:42:08,511 - src.api.app - INFO - Processing new file from watcher: data/technical/equipment_specifications.txt
2025-04-03 02:42:08,512 - src.api.app - INFO - Processing new file from watcher: data/commercial/port_tariffs.txt
2025-04-03 02:42:08,512 - src.api.app - INFO - Processing new file from watcher: data/regulatory/port_regulations.txt
2025-04-03 02:42:08,512 - src.core.document_processor - INFO - Processing file: data/technical/equipment_specifications.txt
2025-04-03 02:42:08,517 - src.core.document_processor - INFO - Processing file: data/commercial/port_tariffs.txt
2025-04-03 02:42:08,527 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:42:08,548 - src.core.document_processor - INFO - Successfully loaded text file with 2217 characters
2025-04-03 02:42:08,574 - src.core.document_processor - INFO - Successfully loaded text file with 4059 characters
2025-04-03 02:42:08,589 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:08,595 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:42:08,676 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:08,595 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:08,698 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:42:08,698 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,747 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,747 - src.core.vector_store - ERROR - Error adding documents to department technical vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,747 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,753 - src.api.app - INFO - File watcher processed data/technical/equipment_specifications.txt with 3 chunks
2025-04-03 02:42:08,753 - src.core.document_processor - INFO - Split 1 documents into 3 chunks
2025-04-03 02:42:08,753 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,753 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,758 - src.core.vector_store - ERROR - Error adding documents to department regulatory vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,758 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,789 - src.api.app - INFO - File watcher processed data/regulatory/port_regulations.txt with 3 chunks
2025-04-03 02:42:08,805 - src.core.document_processor - INFO - Split 1 documents into 5 chunks
2025-04-03 02:42:08,808 - src.core.vector_store - ERROR - Error adding documents to vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,809 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 208, in add_documents
    self.vectorstore.add_documents(chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,814 - src.core.vector_store - ERROR - Error adding documents to department commercial vectorstore: 'MockEmbeddings' object is not callable
2025-04-03 02:42:08,824 - src.core.vector_store - ERROR - Traceback (most recent call last):
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/src/core/vector_store.py", line 242, in add_documents_to_department
    self.department_vectorstores[department].add_documents(dept_chunks)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_core/vectorstores/base.py", line 287, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 340, in add_texts
    embeddings = self._embed_documents(texts)
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in _embed_documents
    return [self.embedding_function(text) for text in texts]
  File "/home/kali/Downloads/projects/ANP_PFE/rag-service/venv/lib/python3.10/site-packages/langchain_community/vectorstores/faiss.py", line 250, in <listcomp>
    return [self.embedding_function(text) for text in texts]
TypeError: 'MockEmbeddings' object is not callable

2025-04-03 02:42:08,829 - src.api.app - INFO - File watcher processed data/commercial/port_tariffs.txt with 5 chunks
2025-04-03 02:42:09,423 - src.core.document_processor - INFO - Successfully loaded PDF with 80 pages
2025-04-03 02:42:09,423 - src.core.document_processor - INFO - Loaded document with 80 sections/pages
2025-04-03 02:42:09,423 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1918_Fr.pdf
2025-04-03 02:42:09,454 - src.core.document_processor - INFO - Successfully loaded PDF with 4 pages
2025-04-03 02:42:09,454 - src.core.document_processor - INFO - Loaded document with 4 sections/pages
2025-04-03 02:42:09,454 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_n1-95-1.pdf
2025-04-03 02:42:09,457 - src.core.document_processor - INFO - Successfully loaded PDF with 5 pages
2025-04-03 02:42:09,457 - src.core.document_processor - INFO - Loaded document with 5 sections/pages
2025-04-03 02:42:09,457 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Dakhla.pdf
2025-04-03 02:42:12,225 - src.core.document_processor - INFO - Successfully loaded PDF with 81 pages
2025-04-03 02:42:12,225 - src.core.document_processor - INFO - Loaded document with 81 sections/pages
2025-04-03 02:42:12,225 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Nador.pdf
2025-04-03 02:42:13,592 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,592 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,592 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:42:13,663 - src.core.vector_store - ERROR - Error in MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,664 - src.core.vector_store - ERROR - Error in similarity search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,664 - src.core.vector_store - INFO - Using emergency fallback, returning 5 documents
2025-04-03 02:42:13,709 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,782 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,793 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:42:13,848 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,858 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,868 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:42:13,963 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,973 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:42:13,978 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:42:14,145 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,155 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,160 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:42:14,267 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,272 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,277 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:42:14,408 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,419 - src.core.vector_store - ERROR - Error in department search for technical: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,429 - src.core.vector_store - INFO - Using emergency fallback for department technical, returning 3 docs
2025-04-03 02:42:14,534 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,547 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,552 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:42:14,607 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,618 - src.core.vector_store - ERROR - Error in department search for commercial: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,623 - src.core.vector_store - INFO - Using emergency fallback for department commercial, returning 5 docs
2025-04-03 02:42:14,739 - src.core.vector_store - ERROR - Error in department MMR search: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,745 - src.core.vector_store - ERROR - Error in department search for regulatory: 'MockEmbeddings' object is not callable
2025-04-03 02:42:14,756 - src.core.vector_store - INFO - Using emergency fallback for department regulatory, returning 5 docs
2025-04-03 02:42:15,003 - src.core.document_processor - INFO - Successfully loaded PDF with 82 pages
2025-04-03 02:42:15,003 - src.core.document_processor - INFO - Loaded document with 82 sections/pages
2025-04-03 02:42:15,003 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Safi.pdf
2025-04-03 02:42:17,716 - src.core.document_processor - INFO - Successfully loaded PDF with 78 pages
2025-04-03 02:42:17,716 - src.core.document_processor - INFO - Loaded document with 78 sections/pages
2025-04-03 02:42:17,716 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Tantan.pdf
2025-04-03 02:42:21,596 - src.core.document_processor - INFO - Successfully loaded PDF with 80 pages
2025-04-03 02:42:21,596 - src.core.document_processor - INFO - Loaded document with 80 sections/pages
2025-04-03 02:42:21,596 - src.core.document_processor - INFO - Processing file: data/regulatory/Dahir_1914_Fr.pdf
2025-04-03 02:42:21,615 - src.core.document_processor - INFO - Successfully loaded PDF with 3 pages
2025-04-03 02:42:21,616 - src.core.document_processor - INFO - Loaded document with 3 sections/pages
2025-04-03 02:42:21,616 - src.core.document_processor - INFO - Processing file: data/regulatory/Code_ISPS.pdf
2025-04-03 02:42:22,328 - src.core.document_processor - INFO - Successfully loaded PDF with 113 pages
2025-04-03 02:42:22,328 - src.core.document_processor - INFO - Loaded document with 113 sections/pages
2025-04-03 02:42:22,328 - src.core.document_processor - INFO - Processing file: data/regulatory/Loi n71-18 .pdf
2025-04-03 02:42:23,070 - src.core.document_processor - INFO - Successfully loaded PDF with 15 pages
2025-04-03 02:42:23,070 - src.core.document_processor - INFO - Loaded document with 15 sections/pages
2025-04-03 02:42:23,071 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Laayoune.pdf
2025-04-03 02:42:25,783 - src.core.document_processor - INFO - Successfully loaded PDF with 78 pages
2025-04-03 02:42:25,783 - src.core.document_processor - INFO - Loaded document with 78 sections/pages
2025-04-03 02:42:25,783 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Mohammedia.pdf
2025-04-03 02:42:27,457 - src.core.document_processor - INFO - Successfully loaded PDF with 70 pages
2025-04-03 02:42:27,458 - src.core.document_processor - INFO - Loaded document with 70 sections/pages
2025-04-03 02:42:27,458 - src.core.document_processor - INFO - Processing file: data/regulatory/REGLEMENT_EXPLOITATION_CASABLANCA.pdf
2025-04-03 02:42:30,898 - src.core.document_processor - INFO - Successfully loaded PDF with 102 pages
2025-04-03 02:42:30,899 - src.core.document_processor - INFO - Loaded document with 102 sections/pages
2025-04-03 02:42:30,899 - src.core.document_processor - INFO - Processing file: data/regulatory/Reglement_dexploitation_port_Agadir.pdf
2025-04-03 02:42:33,973 - src.core.document_processor - INFO - Successfully loaded PDF with 91 pages
2025-04-03 02:42:33,973 - src.core.document_processor - INFO - Loaded document with 91 sections/pages
2025-04-03 02:42:33,973 - src.core.document_processor - INFO - Processing file: data/regulatory/port_regulations.txt
2025-04-03 02:42:33,973 - src.core.document_processor - INFO - Successfully loaded text file with 2343 characters
2025-04-03 02:42:33,973 - src.core.document_processor - INFO - Loaded document with 1 sections/pages
2025-04-03 02:42:33,974 - src.core.document_processor - INFO - Loaded 1025 total documents from all folders
2025-04-03 02:42:34,071 - src.core.document_processor - INFO - Split 1025 documents into 3691 chunks
2025-04-03 02:42:34,072 - src.core.vector_store - INFO - Creating new FAISS index...
2025-04-03 02:42:34,072 - src.core.vector_store - INFO - Creating vectorstore from 3691 chunks
2025-04-03 02:42:34,076 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,267 - src.core.vector_store - INFO - Vectorstore saved to faiss_index
2025-04-03 02:42:34,267 - src.core.vector_store - INFO - Creating new FAISS index for department: general...
2025-04-03 02:42:34,268 - src.core.vector_store - INFO - Creating vectorstore for department general from 137 chunks
2025-04-03 02:42:34,268 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,275 - src.core.vector_store - INFO - Vectorstore for department general saved to faiss_index/general
2025-04-03 02:42:34,275 - src.core.vector_store - INFO - Creating new FAISS index for department: commercial...
2025-04-03 02:42:34,277 - src.core.vector_store - INFO - Creating vectorstore for department commercial from 5 chunks
2025-04-03 02:42:34,277 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,278 - src.core.vector_store - INFO - Vectorstore for department commercial saved to faiss_index/commercial
2025-04-03 02:42:34,278 - src.core.vector_store - INFO - Creating new FAISS index for department: technical...
2025-04-03 02:42:34,279 - src.core.vector_store - INFO - Creating vectorstore for department technical from 3 chunks
2025-04-03 02:42:34,279 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,279 - src.core.vector_store - INFO - Vectorstore for department technical saved to faiss_index/technical
2025-04-03 02:42:34,279 - src.core.vector_store - INFO - Creating new FAISS index for department: safety...
2025-04-03 02:42:34,280 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,280 - src.core.vector_store - INFO - Vectorstore for department safety saved to faiss_index/safety
2025-04-03 02:42:34,280 - src.core.vector_store - INFO - Creating new FAISS index for department: regulatory...
2025-04-03 02:42:34,281 - src.core.vector_store - INFO - Creating vectorstore for department regulatory from 3546 chunks
2025-04-03 02:42:34,283 - langchain_community.vectorstores.faiss - WARNING - `embedding_function` is expected to be an Embeddings object, support for passing in a function will soon be removed.
2025-04-03 02:42:34,459 - src.core.vector_store - INFO - Vectorstore for department regulatory saved to faiss_index/regulatory
2025-04-03 02:42:34,459 - src.api.endpoints - INFO - Successfully rebuilt indexes with 3691 chunks from 1025 documents
2025-04-03 02:43:35,848 - src.core.file_watcher - INFO - File watcher stopped
2025-04-03 02:43:35,849 - src.api.app - INFO - File watcher stopped
